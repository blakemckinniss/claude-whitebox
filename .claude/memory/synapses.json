{
  "patterns": {
    "(scrape|crawl|browser|selenium|e2e|headless|playwright)": [
      "Protocol: The Headless Protocol (Playwright browser automation)",
      "Tool: scripts/lib/browser.py",
      "Lesson: Do NOT use requests/BeautifulSoup for JavaScript sites",
      "Action: Use get_browser_session() context manager"
    ],
    "(sql|query|database|migration|schema|postgres|mysql)": [
      "Protocol: The Oracle Protocol (consult before major changes)",
      "Protocol: The Cartesian Protocol (think.py for decomposition)",
      "Memory: Check active_context.md for current DB state",
      "Caution: Run skeptic.py before migrations"
    ],
    "(api|fetch|request|http|rest|endpoint)": [
      "Protocol: The Research Protocol (search for current API docs)",
      "Protocol: The Probe Protocol (verify methods with probe.py)",
      "Tool: Use urllib for simple requests (stdlib)",
      "Lesson: Never guess API methods - probe or research first"
    ],
    "(refactor|rewrite|optimize|restructure)": [
      "Protocol: The Cartesian Protocol (think.py + skeptic.py MANDATORY)",
      "Tool: scripts/ops/xray.py for structural analysis",
      "Caution: Beware sunk cost fallacy - sometimes rewrite > patch",
      "Action: Run audit.py after refactoring"
    ],
    "(bug|error|fail|exception|crash|broken)": [
      "Protocol: The MacGyver Protocol (improvise if tools missing)",
      "Memory: Search lessons.md for similar errors",
      "Tool: scripts/ops/inventory.py to check available tools",
      "Action: Write to lessons.md after fixing"
    ],
    "(search|find|grep|locate|where)": [
      "Protocol: The X-Ray Protocol (structural code search)",
      "Tool: scripts/ops/xray.py for definitions/classes",
      "Tool: Use Grep for text search, not structure",
      "Distinction: Text search vs Structure search"
    ],
    "(test|spec|unit|integration|pytest)": [
      "Tool: .claude/tests/runner.py",
      "Protocol: Run tests before committing",
      "Memory: Check test philosophy in CLAUDE.md",
      "Action: Write tests for new features"
    ],
    "(security|secret|key|token|credential|password)": [
      "Protocol: The Sentinel Protocol (audit.py for hardcoded secrets)",
      "Caution: NEVER hardcode credentials - use .env",
      "Tool: pre_write_audit.py hook blocks deadly sins",
      "Action: Check anti_patterns.md for security sins"
    ],
    "(install|pip|npm|package|dependency)": [
      "Protocol: The MacGyver Protocol (Living off the Land)",
      "Tool: scripts/ops/inventory.py to check what's available",
      "Philosophy: Prefer stdlib over external dependencies",
      "Action: Check if Python stdlib can solve it first"
    ],
    "(commit|git|push|pr|pull request)": [
      "Protocol: The Sentinel Protocol (run audit.py first)",
      "Protocol: The Upkeep Protocol (run upkeep.py before commit)",
      "Tool: scripts/ops/pre_commit.py",
      "Action: Update index, verify requirements, clean scratch"
    ],
    "(memory|remember|forget|context|history)": [
      "Protocol: The Elephant Protocol (persistent memory)",
      "Tool: scripts/ops/remember.py",
      "Memory: active_context.md (short-term)",
      "Memory: decisions.md (medium-term)",
      "Memory: lessons.md (long-term pain log)"
    ],
    "(parallel|batch|concurrent|multiple|bulk)": [
      "Tool: scripts/lib/parallel.py for high-performance batching",
      "Protocol: Use parallel execution for >3 items",
      "Philosophy: Visual feedback via tqdm required",
      "Lesson: Batch scripts must not crash on single failures"
    ],
    "(json|parse|data|format)": [
      "Tool: python3 -m json.tool (no jq needed)",
      "Protocol: The MacGyver Protocol (stdlib over jq)",
      "Tool: jq if available (check inventory.py)",
      "Action: Use Python json module for complex parsing"
    ],
    "(quality|lint|check|validate|audit)": [
      "Protocol: The Sentinel Protocol (automated quality gates)",
      "Tool: scripts/ops/audit.py",
      "Tool: scripts/ops/drift_check.py for style",
      "Action: Run in strict mode for CI/CD"
    ],
    "(think|plan|design|architect|approach)": [
      "Protocol: The Cartesian Protocol (meta-cognition)",
      "Tool: scripts/ops/think.py for decomposition",
      "Tool: scripts/ops/skeptic.py for hostile review",
      "Philosophy: Think → Skepticize → Code"
    ],
    "(research|docs|documentation|current|latest)": [
      "Protocol: The Research Protocol (Tavily search)",
      "Tool: scripts/ops/research.py",
      "Caution: Training data cutoff is January 2025",
      "Action: Always research before using updated libraries"
    ],
    "(inspect|introspect|probe|verify|methods)": [
      "Protocol: The Probe Protocol (anti-hallucination)",
      "Tool: scripts/ops/probe.py",
      "Philosophy: Never guess API methods",
      "Action: Probe runtime to verify signatures"
    ],
    "(consult|advice|oracle|reasoning)": [
      "Protocol: The Oracle Protocol (external reasoning)",
      "Tool: scripts/ops/consult.py",
      "Use: Architecture decisions, complex design",
      "Philosophy: Catch edge cases via external LLM"
    ]
  },
  "random_constraints": [
    "Constraint: What if you couldn't use Python? How would you solve this in Bash?",
    "Constraint: What if you had to do this in 1 line? No loops, no functions.",
    "Perspective: How would a security researcher exploit this code?",
    "Perspective: What would break if this ran in production with 1 million users?",
    "Simplification: Can you delete code to solve this problem instead of adding?",
    "Optimization: What if this had to run on a Raspberry Pi with 512MB RAM?",
    "Reliability: What if the network fails halfway through this operation?",
    "Lateral: How would a 1990s developer solve this without modern libraries?",
    "Inversion: Instead of asking 'how to do X', ask 'why do we need X at all?'",
    "Constraint: What if you had to explain this to a non-technical stakeholder?"
  ],
  "meta": {
    "version": "1.0.0",
    "description": "The Synapse Map: Associative memory linking keywords to protocols, tools, and lessons",
    "constraint_probability": 0.10,
    "max_associations": 5,
    "max_memories": 3
  }
}
